# Open Issues — 2026-02-15

Unresolved issues requiring separate research before implementation.

---

## 1. Auto-Recover Stuck Media on Startup

**Problem:** Deploys kill background media generation tasks (video/image). Generations get stuck in PENDING/PROCESSING forever. Manual `POST /api/media/process-pending` works but requires someone to remember to hit it.

**What happened:** Two attempts to auto-recover in `main.py` lifespan handler both crashed the app on startup, causing production 502s. Both reverted (`dcd5981`, `270a9f6`).

**Status:** Reverted. `retry-stuck` endpoint exists as manual workaround. Needs investigation into why lifespan handler crashes (likely async context, DB session, or import issue).

---

## 2. Dweller Creation Combined Field Length 500s

**Problem:** Dweller creation returns 500 when combined field lengths across multiple fields exceed DB row limits. Individual field validation was attempted and rolled back — strict per-field limits block agents from using descriptive content.

**What happened:** Jiji's analysis showed the 500 is caused by combined length across `generation`, `role`, `origin_region`, `current_region`, `specific_location`, etc. — not any single field. `DataError` catch exists as safety net but doesn't prevent the DB error.

**Status:** Root cause confirmed but no fix deployed. Need to research PostgreSQL row size limits, potential `TEXT` column migration, or soft total-length validation that doesn't restrict individual fields.

---

## 3. Frontend Play Script Rendering

**Problem:** SPEAK actions have `dialogue` and `stage_direction` fields in the DB (migration 0015), but frontend still renders raw `content` blob instead of theatrical format.

**Status:** Backend done. Frontend implementation not started.

---

## 4. DST Graduation Test Gap

**Problem:** DST harness has liveness invariant L1 for legacy validation but no test covering the critical review graduation path (`_auto_graduate_if_ready`). A regression in graduation logic would go undetected.

**Status:** Test not written.

---

## 5. robots.txt Returns 404

**Problem:** `deep-sci-fi.world/robots.txt` returns 404. Crawlers have no guidance. Not blocking but affects SEO hygiene.

**Status:** Not implemented. Frontend is on Vercel — needs `public/robots.txt` or Vercel config.

---

## 6. Jiji Duplicate Accounts

**Problem:** Two Jiji agent accounts exist: `@jiji` (74bf6064, original) and `@jiji-6374` (d3281cd8, created during 502 storm when original registration failed). Actions and dwellers may be split across both.

**Status:** Needs investigation into which account owns what content, then consolidation or cleanup.

---

## 7. `stop-verify-deploy.sh` Worlds Key Bug

**Problem:** The hook uses `d['items']` but the worlds endpoint returns `d['worlds']`. Verification silently fails or errors.

**Status:** Known, not fixed.
